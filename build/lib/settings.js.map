{"version":3,"sources":["../../src/lib/settings.js"],"names":["db","require","main","p","promisify","getObject","getObjectField","setObject","convert","checkingInterval","x","parseInt","respondIfCanReply","mainPostOnly","getSettings","setSettings","settings","getSetting","key","value","Error"],"mappings":";;;;;;;;;;;;;AAEA,MAAMA,KAAKC,QAAQC,IAAR,CAAaD,OAAb,CAAqB,gBAArB,CAAX;;AAEA,MAAME,IAAI,mBAAQC,SAAlB;AACA,MAAMC,YAAYF,EAAEH,GAAGK,SAAL,CAAlB;AACA,MAAMC,iBAAiBH,EAAEH,GAAGM,cAAL,CAAvB;AACA,MAAMC,YAAYJ,EAAEH,GAAGO,SAAL,CAAlB;;AAEA,MAAMC,UAAU;AACdC,oBAAkBC,KAAKC,SAASD,CAAT,EAAY,EAAZ,KAAmB,OAAO,EAAP,GAAY,CADxC;AAEdE,qBAAmBF,KAAKA,MAAM,IAAN,IAAcA,MAAM,MAF9B;AAGdG,gBAAcH,KAAKA,MAAM,IAAN,IAAcA,MAAM;AAHzB,CAAhB;;AAMA,MAAMI;AAAA,sCAAc,aAAY;AAAA,gBACgC,OAAMT,UAAU,0BAAV,CAAN,KAA+C,EAD/E;;AAAA,UACtBI,gBADsB,SACtBA,gBADsB;AAAA,UACJG,iBADI,SACJA,iBADI;AAAA,UACeC,YADf,SACeA,YADf;;AAE9B,WAAO;AACLJ,wBAAkBD,QAAQC,gBAAR,CAAyBA,gBAAzB,CADb;AAELG,yBAAmBJ,QAAQI,iBAAR,CAA0BA,iBAA1B,CAFd;AAGLC,oBAAcL,QAAQK,YAAR,CAAqBA,YAArB;AAHT,KAAP;AAKD,GAPK;;AAAA;AAAA;AAAA;AAAA,IAAN;;AASA,MAAME,cAAcC,YAAYT,UAAU,0BAAV,EAAsCS,QAAtC,CAAhC;;AAEA,MAAMC;AAAA,uCAAa,WAAOC,GAAP,EAAe;AAChC,UAAMC,QAAQ,MAAMb,eAAe,0BAAf,EAA2CY,GAA3C,CAApB;AACA,QAAI,CAACV,QAAQU,GAAR,CAAL,EAAmB;AACjB,YAAME,MAAM,cAAN,CAAN;AACD;AACD,WAAOZ,QAAQU,GAAR,EAAaC,KAAb,CAAP;AACD,GANK;;AAAA;AAAA;AAAA;AAAA,IAAN;;QASEL,W,GAAAA,W;QACAG,U,GAAAA,U;QACAF,W,GAAAA,W","file":"settings.js","sourcesContent":["import Promise from 'bluebird';\n\nconst db = require.main.require('./src/database');\n\nconst p = Promise.promisify;\nconst getObject = p(db.getObject);\nconst getObjectField = p(db.getObjectField);\nconst setObject = p(db.setObject);\n\nconst convert = {\n  checkingInterval: x => parseInt(x, 10) || 1000 * 60 * 5,\n  respondIfCanReply: x => x === true || x === 'true',\n  mainPostOnly: x => x === true || x === 'true',\n};\n\nconst getSettings = async () => {\n  const { checkingInterval, respondIfCanReply, mainPostOnly } = await getObject('plugin-calendar:settings') || {};\n  return {\n    checkingInterval: convert.checkingInterval(checkingInterval),\n    respondIfCanReply: convert.respondIfCanReply(respondIfCanReply),\n    mainPostOnly: convert.mainPostOnly(mainPostOnly),\n  };\n};\n\nconst setSettings = settings => setObject('plugin-calendar:settings', settings);\n\nconst getSetting = async (key) => {\n  const value = await getObjectField('plugin-calendar:settings', key);\n  if (!convert[key]) {\n    throw Error('invalid-data');\n  }\n  return convert[key](value);\n};\n\nexport {\n  getSettings,\n  getSetting,\n  setSettings,\n};\n"]}